{"description": "Azure AD ATT&CK Matrix Coverage for Azure Sentinel", "name": "Azure AD Layer Json File for Azure Sentinel", "domain": "mitre-enterprise", "version": "3.0", "filters": {"stages": ["act"], "platforms": ["Azure AD"]}, "techniques": [{"score": 1, "techniqueID": "T1528", "metadata": [{"name": "Suspicious application consent for offline access", "value": "AuditLogs"}, {"name": "Suspicious application consent similar to O365 Attack Toolkit", "value": "AuditLogs"}, {"name": "Suspicious application consent similar to PwnAuth", "value": "AuditLogs"}]}, {"score": 1, "techniqueID": "T1550", "metadata": [{"name": "Suspicious application consent similar to O365 Attack Toolkit", "value": "AuditLogs"}, {"name": "Suspicious application consent similar to PwnAuth", "value": "AuditLogs"}]}, {"score": 1, "techniqueID": "T1098", "metadata": [{"name": "User added to Azure Active Directory Privileged Groups", "value": "AuditLogs"}, {"name": "Anomalous login followed by Teams action", "value": "SigninLogs"}, {"name": "MFA disabled for a user", "value": "AuditLogs"}, {"name": "Sign-ins from IPs that attempt sign-ins to disabled accounts", "value": "SigninLogs"}, {"name": "Attempt to bypass conditional access rule in Azure AD", "value": "SigninLogs"}, {"name": "Anomalous Role Assignment", "value": "BehaviorAnalytics"}, {"name": "Anomalous Role Assignment", "value": "AuditLogs"}, {"name": "Anomalous AAD Account Manipulation", "value": "BehaviorAnalytics"}, {"name": "Anomalous AAD Account Manipulation", "value": "AuditLogs"}, {"name": "Login attempts using Legacy Auth", "value": "SigninLogs"}]}, {"score": 1, "techniqueID": "T1078", "metadata": [{"name": "User added to Azure Active Directory Privileged Groups", "value": "AuditLogs"}, {"name": "IP with multiple failed Azure AD logins successfully logs in to Palo Alto VPN", "value": "SigninLogs"}, {"name": "Cisco - firewall block but success logon to Azure AD", "value": "SigninLogs"}, {"name": "Anomalous login followed by Teams action", "value": "SigninLogs"}, {"name": "Failed AWS Console logons but success logon to AzureAD", "value": "SigninLogs"}, {"name": "Failed AzureAD logons but success logon to host", "value": "SigninLogs"}, {"name": "Multiple Password Reset by user", "value": "AuditLogs"}, {"name": "Failed AzureAD logons but success logon to AWS Console", "value": "SigninLogs"}, {"name": "Failed host logons but success logon to AzureAD", "value": "SigninLogs"}, {"name": "User Login from Different Countries within 3 hours", "value": "Okta_CL"}, {"name": "Sign-ins from IPs that attempt sign-ins to disabled accounts", "value": "SigninLogs"}, {"name": "Anomalous sign-in location by user account and authenticating application", "value": "SigninLogs"}, {"name": "Successful logon from IP and failure from a different IP", "value": "SigninLogs"}, {"name": "Attempt to bypass conditional access rule in Azure AD", "value": "SigninLogs"}, {"name": "Attempts to sign in to disabled accounts", "value": "SigninLogs"}, {"name": "Tracking Password Changes", "value": "AuditLogs"}, {"name": "Tracking Password Changes", "value": "SigninLogs"}, {"name": "Tracking Privileged Account Rare Activity", "value": "SigninLogs"}, {"name": "Failed Login Attempt by Expired account", "value": "SigninLogs"}, {"name": "Anomalous Geo Location Logon", "value": "BehaviorAnalytics"}, {"name": "Anomalous Geo Location Logon", "value": "SigninLogs"}, {"name": "Anomalous Sign-in Activity", "value": "BehaviorAnalytics"}, {"name": "Anomalous Sign-in Activity", "value": "SigninLogs"}, {"name": "Anomalous Login to Devices", "value": "BehaviorAnalytics"}, {"name": "Login attempt by Blocked MFA user", "value": "SigninLogs"}, {"name": "Azure Active Directory signins from new locations", "value": "SigninLogs"}, {"name": "Attempts to sign in to disabled accounts by IP address", "value": "SigninLogs"}, {"name": "Anomalous sign-in location by user account and authenticating application - with sign-in details", "value": "SigninLogs"}, {"name": "Login attempts using Legacy Auth", "value": "SigninLogs"}, {"name": "Anomalous Azure Active Directory apps based on authentication location", "value": "SigninLogs"}, {"name": "Inactive or new account signins", "value": "SigninLogs"}, {"name": "Failed attempt to access Azure Portal", "value": "SigninLogs"}, {"name": "Attempts to sign in to disabled accounts by account name", "value": "SigninLogs"}]}, {"score": 1, "techniqueID": "T1136", "metadata": [{"name": "Rare application consent", "value": "AuditLogs"}, {"name": "Anomalous login followed by Teams action", "value": "SigninLogs"}, {"name": "Consent to Application discovery", "value": "AuditLogs"}, {"name": "Rare Audit activity initiated by App", "value": "AuditLogs"}, {"name": "Rare Audit activity initiated by User", "value": "AuditLogs"}, {"name": "Anomalous AAD Account Creation", "value": "BehaviorAnalytics"}, {"name": "Anomalous AAD Account Creation", "value": "AuditLogs"}]}, {"score": 1, "techniqueID": "", "metadata": [{"name": "(Preview) TI map IP entity to SigninLogs", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map IP entity to SigninLogs", "value": "SigninLogs"}, {"name": "(Preview) TI map Domain entity to PaloAlto", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map Domain entity to SecurityAlert", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map IP entity to AWSCloudTrail", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map File Hash to Security Event", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map Email entity to SecurityAlert", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map Email entity to CommonSecurityLog", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map Domain entity to CommonSecurityLog", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map IP entity to W3CIISLog", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map URL entity to Syslog data", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map IP entity to VMConnection", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map Email entity to OfficeActivity", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map URL entity to SecurityAlert data", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map Email entity to SecurityEvent", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map IP entity to DnsEvents", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map File Hash to CommonSecurityLog Event", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map Domain entity to Syslog", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map URL entity to AuditLogs", "value": "AuditLogs"}, {"name": "(Preview) TI map URL entity to AuditLogs", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map IP entity to OfficeActivity", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map IP entity to WireData", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map IP entity to AzureActivity", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map URL entity to OfficeActivity data", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map Email entity to AzureActivity", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map Domain entity to DnsEvent", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map URL entity to PaloAlto data", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map Email entity to SigninLogs", "value": "ThreatIntelligenceIndicator"}, {"name": "(Preview) TI map Email entity to SigninLogs", "value": "SigninLogs"}, {"name": "Known IRIDIUM IP", "value": "SigninLogs"}, {"name": "TI map IP entity to GitHub_CL", "value": "ThreatIntelligenceIndicator"}, {"name": "Preview - TI map File entity to Syslog Event", "value": "ThreatIntelligenceIndicator"}, {"name": "Preview - TI map File entity to Security Event", "value": "ThreatIntelligenceIndicator"}, {"name": "Preview - TI map File entity to VMConnection Event", "value": "ThreatIntelligenceIndicator"}, {"name": "Preview - DNS Events that match threat intelligence", "value": "ThreatIntelligenceIndicator"}, {"name": "Preview - TI map File entity to OfficeActivity Event", "value": "ThreatIntelligenceIndicator"}, {"name": "Preview - TI map File entity to WireData Event", "value": "ThreatIntelligenceIndicator"}, {"name": "Anomalous Resource Access", "value": "BehaviorAnalytics"}, {"name": "Anomalous RDP Activity", "value": "BehaviorAnalytics"}, {"name": "Signin Logs with expanded Conditional Access Policies", "value": "SigninLogs"}]}, {"score": 1, "techniqueID": "T1190", "metadata": [{"name": "Rare domains seen in Cloud Logs", "value": "SigninLogs"}, {"name": "Rare domains seen in Cloud Logs", "value": "AuditLogs"}]}, {"score": 1, "techniqueID": "T1110", "metadata": [{"name": "IP with multiple failed Azure AD logins successfully logs in to Palo Alto VPN", "value": "SigninLogs"}, {"name": "Failed AWS Console logons but success logon to AzureAD", "value": "SigninLogs"}, {"name": "Failed AzureAD logons but success logon to host", "value": "SigninLogs"}, {"name": "Multiple Password Reset by user", "value": "AuditLogs"}, {"name": "Failed AzureAD logons but success logon to AWS Console", "value": "SigninLogs"}, {"name": "Failed host logons but success logon to AzureAD", "value": "SigninLogs"}, {"name": "Failed Logins from Unknown or Invalid User", "value": "Okta_CL"}, {"name": "Potential Password Spray Attack", "value": "Okta_CL"}, {"name": "Failed login attempts to Azure Portal", "value": "SigninLogs"}, {"name": "Password spray attack against Azure AD application", "value": "SigninLogs"}, {"name": "Brute Force Attack against GitHub Account", "value": "SigninLogs"}, {"name": "Brute force attack against Azure Portal", "value": "SigninLogs"}, {"name": "Successful logon from IP and failure from a different IP", "value": "SigninLogs"}, {"name": "GitHub Signin Burst from Multiple Locations", "value": "SigninLogs"}, {"name": "Distributed Password cracking attempts in AzureAD", "value": "SigninLogs"}, {"name": "Permutations on logon attempts by UserPrincipalNames indicating potential brute force", "value": "SigninLogs"}, {"name": "Failed service logon attempt by user account with available AuditData", "value": "SigninLogs"}, {"name": "Failed service logon attempt by user account with available AuditData", "value": "AuditLogs"}, {"name": "Tracking Password Changes", "value": "AuditLogs"}, {"name": "Tracking Password Changes", "value": "SigninLogs"}, {"name": "Azure Active Directory sign-in burst from multiple locations", "value": "SigninLogs"}]}, {"score": 1, "techniqueID": "T1059", "metadata": [{"name": "Anomalous Code Execution", "value": "BehaviorAnalytics"}]}, {"score": 1, "techniqueID": "T1114", "metadata": [{"name": "Rare domains seen in Cloud Logs", "value": "SigninLogs"}, {"name": "Rare domains seen in Cloud Logs", "value": "AuditLogs"}]}, {"score": 1, "techniqueID": "T1199", "metadata": [{"name": "Anomalous login followed by Teams action", "value": "SigninLogs"}]}, {"score": 1, "techniqueID": "T1530", "metadata": [{"name": "Anomalous Data Access", "value": "BehaviorAnalytics"}]}, {"score": 1, "techniqueID": "T1087", "metadata": [{"name": "Rare domains seen in Cloud Logs", "value": "SigninLogs"}, {"name": "Rare domains seen in Cloud Logs", "value": "AuditLogs"}, {"name": "Tracking Privileged Account Rare Activity", "value": "SigninLogs"}, {"name": "Same User - Successful logon for a given App and failure on another App within 1m and low distribution", "value": "SigninLogs"}]}, {"score": 1, "techniqueID": "T1531", "metadata": [{"name": "Anomalous Password Reset", "value": "BehaviorAnalytics"}, {"name": "Anomalous Password Reset", "value": "AuditLogs"}]}, {"score": 1, "techniqueID": "T1562", "metadata": [{"name": "Anomalous Defensive Mechanism Modification", "value": "BehaviorAnalytics"}]}, {"score": 1, "techniqueID": "T1110.001", "metadata": [{"name": "Anomalous Failed Logon", "value": "BehaviorAnalytics"}, {"name": "Anomalous Failed Logon", "value": "SigninLogs"}]}, {"score": 1, "techniqueID": "T1021", "metadata": [{"name": "Same User - Successful logon for a given App and failure on another App within 1m and low distribution", "value": "SigninLogs"}]}], "gradient": {"colors": ["#ffffff", "##8ec843"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "Techniques researched", "color": "#66fff3"}]}